---
description: Git commit message conventions and commitlint rules
globs: ["**/.git/COMMIT_EDITMSG", "**/.gitmessage", ".commitlintrc.js"]
---

<details>
<summary>Rule Metadata</summary>

- **Version**: 1.0.0
- **Created**: 2024-02-22
- **Updated**: 2024-02-22
- **Dependencies**:
  - cursor-global-rules
  - validation-rules
- **Tags**:
  - git
  - commits
  - conventions
  - commitlint

</details>

# Git Commit Rules

> Standardized commit message format using conventional commits, commitlint, and cz-git.

## Commit Message Structure

### Format

```sh
<type>(<scope>): <description>

[optional body]

[optional footer(s)]
```

### Types

1. **Primary Types**
   - `feat`: âœ¨ New feature
   - `fix`: ðŸ› Bug fix
   - `docs`: ðŸ“ Documentation changes
   - `style`: ðŸ’„ Code style changes (formatting, etc.)
   - `refactor`: â™»ï¸ Code refactoring
   - `perf`: âš¡ï¸ Performance improvements
   - `test`: âœ… Adding or modifying tests
   - `build`: ðŸ“¦ï¸ Build system changes
   - `ci`: ðŸŽ¡ CI configuration changes
   - `chore`: ðŸ”¨ Other changes

2. **Additional Types**
   - `revert`: âªï¸ Revert previous changes
   - `deps`: ðŸ“Œ Dependency updates
   - `security`: ðŸ”’ Security fixes
   - `i18n`: ðŸŒ Internationalization
   - `a11y`: â™¿ï¸ Accessibility improvements

### Scopes

```typescript
type ValidScope =
  | 'rules'      // Rule system changes
  | 'memory'     // Memory system
  | 'validation' // Validation rules
  | 'core'       // Core functionality
  | 'docs'       // Documentation
  | 'test'       // Testing infrastructure
  | 'config'     // Configuration
```

## Commit Workflows

### 1. Direct Commits (Quick)

Use this method when you know the exact commit type and message:

```bash
git commit -m "type(scope): message"
```

Examples:

```bash
git commit -m "feat(rules): add new validation rule"
git commit -m "fix(core): resolve memory leak"
git commit -m "docs(config): update setup instructions"
```

### 2. Interactive Commits (Guided)

Use this method when you want a guided process:

```bash
pnpm commit
# or
npm run commit
```

This will:

- Show available commit types with emojis
- List valid scopes
- Guide you through the commit message format
- Help with breaking changes and issue references

## Configuration Files

### Base Configuration (.commitlintrc.js)

```javascript
// @ts-check
import { defineConfig } from 'cz-git';

/** @type {import('cz-git').UserConfig} */
const config = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [2, 'always', [
      'feat', 'fix', 'docs', 'style', 'refactor',
      'perf', 'test', 'build', 'ci', 'chore',
      'revert', 'deps', 'security', 'i18n', 'a11y'
    ]],
    'scope-enum': [2, 'always', [
      'rules', 'memory', 'validation', 'core',
      'docs', 'test', 'config'
    ]],
    'scope-case': [2, 'always', ['lower-case']],
    'subject-case': [2, 'always', ['lower-case']],
    'subject-full-stop': [2, 'never', '.'],
    'subject-min-length': [2, 'always', 5],
    'subject-max-length': [2, 'always', 100],
    'body-max-line-length': [2, 'always', 100],
    'footer-max-line-length': [2, 'always', 100]
  }
};

export default defineConfig(config);
```

### Package Configuration (package.json)

```json
{
  "type": "module",
  "scripts": {
    "commit": "git-cz"
  },
  "config": {
    "commitizen": {
      "path": "node_modules/cz-git",
      "disableScopeLowerCase": false,
      "disableSubjectLowerCase": false,
      "maxHeaderLength": 100,
      "maxSubjectLength": 100,
      "minSubjectLength": 5
    }
  }
}
```

## Git Hooks

### Pre-commit Hook (.husky/pre-commit)

```bash
npx lint-staged
```

### Commit Message Hook (.husky/commit-msg)

```bash
npx --no -- commitlint --edit ${1}
```

## Validation Rules

### Message Validation

```mermaid
Commit Validation
â”œâ”€â”€ Format Check
â”‚   â”œâ”€â”€ Type validation
â”‚   â”œâ”€â”€ Scope validation
â”‚   â””â”€â”€ Description format
â”œâ”€â”€ Content Check
â”‚   â”œâ”€â”€ Length limits
â”‚   â”œâ”€â”€ Case rules
â”‚   â””â”€â”€ Punctuation
â””â”€â”€ Reference Check
    â”œâ”€â”€ Issue links
    â”œâ”€â”€ Breaking changes
    â””â”€â”€ Co-authors
```

### Common Errors

1. **Invalid Type**

   ```sh
   âŒ feature(rules): add validation
   âœ… feat(rules): add validation
   ```

2. **Invalid Scope**

   ```sh
   âŒ feat(RULES): add validation
   âœ… feat(rules): add validation
   ```

3. **Invalid Subject**

   ```sh
   âŒ feat(rules): Add Validation.
   âœ… feat(rules): add validation
   ```

## Module System

The project uses ES modules (ESM) by default:

- `"type": "module"` in `package.json` enables ES modules for all `.js` files
- Use `import`/`export` syntax in JavaScript files
- Configuration files use ES modules (e.g., `.commitlintrc.js`)
- No need for `.mjs` extension as `.js` files are treated as modules by default

> ðŸ’¡ **Note**: These commit rules ensure consistent and meaningful commit history. Choose between direct commits for quick changes or interactive commits for guided assistance.
